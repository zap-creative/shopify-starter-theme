{%- assign centered = section.settings.align_logo | strip | remove: 'center' | size -%}

{%- capture logo -%}
  {% if settings.logo %}
    {%- assign img_url = settings.logo | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
    {% capture logo_alt %}{{ settings.logo.alt | default: shop.name }}{% endcapture %}
      <img class="lazyload js"
        src="{{ settings.logo | img_url: '300x300' }}"
        data-src="{{ img_url }}"
        data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048]"
        data-aspectratio="{{ settings.logo.aspect_ratio }}"
        data-sizes="auto"
        alt="{{ logo_alt | escape }}"
        style="max-width: {{ settings.logo_max_width }}px">
      <noscript>
        {% capture image_size %}{{ settings.logo_max_width | escape }}x{% endcapture %}
        <img src="{{ settings.logo | img_url: image_size }}"
          srcset="{{ settings.logo | img_url: image_size }} 1x, {{ settings.logo | img_url: image_size, scale: 2 }} lg"
          alt="{{ settings.logo.alt | default: shop.name }}"
          style="max-width: {{ settings.logo_max_width }}px;">
      </noscript>
      <span class="sr-only">{{ shop.name }}</span>
    </a>
  {% else %}
    {{ shop.name }}
  {% endif %}
{%- endcapture -%}

<div class="site-header {% if centered == 0 -%}site-header--centered{%- endif -%}"
  data-section-id="{{ section.id }}"
  data-section-type="header-section"
  data-header-section
  role="banner"
>
  {% if centered == 0 -%}
    <div class="w-full pb-5 flex flex-none sm-down:hidden">
      {{- logo -}}
    </div>
  {%- endif %}

  {% if template.name == 'index' -%}
    <h1 class="site-title {% if centered == 0 %}tablet:hidden{% endif %}" itemscope itemtype="http://schema.org/Organization">
  {%- else -%}
    <div class="site-title" itemscope itemtype="http://schema.org/Organization">
  {%- endif -%}
    <a href="/" itemprop="url" class="site-header__logo">
      {{- logo -}}
    </a>
  {%- if template.name == 'index' -%}</h1>{%- else -%}</div>{%- endif -%}

  <nav id="site-navigation" class="sm-down:hidden" role="navigation">
    {% render 'navigation' with linklist: section.settings.linklist %}
  </nav>

  <nav id="site-actions" class="site-actions" role="navigation">
    {% if shop.customer_accounts_enabled -%}
    <a href="/account"><i class="material-icons-outlined">person</i></a>
    {%- endif %}
    <a href="{{ routes.search_url }}" class="open-search"><i class="material-icons-outlined">search</i></a>
    {%- if request.page_type != 'cart' -%}
      <a href="/cart" class="open-cart">
    {%- else -%}
      <a href="#cart">
    {%- endif -%}<i class="material-icons-outlined">shopping_cart</i></a>
    </a>
    <a href="#" class="tablet:hidden toggle-mobile-navigation">
      <i class="material-icons-outlined">menu</i>
    </a>
  </nav>

</div>

<nav id="mobile-navigation" class="tablet:hidden critical-hidden">
  {% render 'mobile-navigation' with linklist: section.settings.mobile_linklist %}
</nav>

{% schema %}
  {
    "name": "Site Header",
    "tag": "header",
    "settings": [
      {
        "type": "header",
        "content": "Logo"
      },
      {
        "type": "select",
        "id": "align_logo",
        "label": "Alignment",
        "default": "left",
        "options": [
          {
            "value": "center",
            "label": "Centered"
          },
          {
            "value": "left",
            "label": "Left (default)"
          }
        ]
      },
      {
        "type": "header",
        "content": "Menus"
      },
      {
        "type": "link_list",
        "id": "linklist",
        "label": "Desktop Menu",
        "default": "main-menu"
      },
      {
        "type": "link_list",
        "id": "mobile_linklist",
        "label": "Mobile Menu",
        "default": "main-menu"
      },
      {
        "type": "header",
        "content": "Advanced"
      },
      {
        "type": "text",
        "id": "html_id",
        "label": "CSS id"
      },
      {
        "type": "text",
        "id": "html_classes",
        "label": "CSS classes"
      }
    ]
  }
{% endschema %}